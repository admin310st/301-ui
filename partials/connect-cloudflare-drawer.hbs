<!-- Connect Cloudflare Drawer -->
    <aside class="drawer" data-drawer="connect-cloudflare" hidden>
      <div class="drawer__overlay" data-drawer-close></div>
      <div class="drawer__panel">
        <header class="drawer__header">
          <div class="drawer__title">
            <span class="icon icon--lg" data-icon="brand/cloudflare" style="color: var(--cf-orange);"></span>
            <h2 class="h4">Connect Cloudflare</h2>
          </div>
          <button class="btn-close" type="button" data-drawer-close aria-label="Close">
            <span class="icon" data-icon="mono/close"></span>
          </button>
        </header>

        <div class="drawer__body">
          <div class="tabs">
            <!-- Tabs Navigation -->
            <div class="tabs__nav" role="tablist">
              <button
                class="tabs__trigger is-active"
                role="tab"
                aria-selected="true"
                data-tab-trigger="instructions"
              >
                <span class="icon" data-icon="mono/help-circle"></span>
                <span>Instructions</span>
              </button>
              <button
                class="tabs__trigger"
                role="tab"
                aria-selected="false"
                data-tab-trigger="scoped-token"
              >
                <span class="icon" data-icon="mono/shield-account"></span>
                <span>Scoped Token</span>
              </button>
              <button
                class="tabs__trigger"
                role="tab"
                aria-selected="false"
                data-tab-trigger="quick-setup"
              >
                <span class="icon" data-icon="mono/zap"></span>
                <span>Quick Setup</span>
              </button>
            </div>

            <!-- Tab Panels -->
            <div class="tabs__panels">
              <!-- Instructions Tab -->
              <div class="tabs__panel is-active" data-tab-panel="instructions" role="tabpanel">
                <div class="stack-list">
                  <div class="alert alert--info">
                    <div class="alert__content">
                      <p><strong>Choose your method:</strong></p>
                      <ul style="margin-top: var(--space-1); padding-left: var(--space-4); margin-bottom: 0;">
                        <li><strong>Scoped Token</strong> (Recommended) â€” Secure, minimal permissions</li>
                        <li><strong>Quick Setup</strong> â€” Fast but uses Global API Key temporarily</li>
                      </ul>
                    </div>
                  </div>

                  <div class="card card--panel">
                    <header class="card__header">
                      <h3 class="h5">Creating Bootstrap Token</h3>
                    </header>
                    <div class="card__body">
                      <ol style="padding-left: var(--space-4); margin: 0;">
                        <li style="margin-bottom: var(--space-2);">Go to <a href="https://dash.cloudflare.com" target="_blank" rel="noopener">Cloudflare Dashboard</a> â†’ <strong>Manage account â†’ Account API tokens</strong></li>
                        <li style="margin-bottom: var(--space-2);">Click <strong>Get started</strong> (Create Custom Token)</li>
                        <li style="margin-bottom: var(--space-2);">Set <strong>Token name:</strong> <code>301.st Bootstrap</code></li>
                        <li style="margin-bottom: var(--space-2);"><strong>Permissions:</strong> Add two rows:
                          <ul style="margin-top: var(--space-1); padding-left: var(--space-3); margin-bottom: 0;">
                            <li><code>Account</code> â†’ <code>Account Settings</code> â†’ <strong>Edit</strong></li>
                            <li><code>Account</code> â†’ <code>API Tokens</code> â†’ <strong>Edit</strong></li>
                          </ul>
                        </li>
                        <li style="margin-bottom: var(--space-2);">Click <strong>Continue to summary</strong> â†’ <strong>Create Token</strong></li>
                        <li>Copy the entire <strong>Test this token</strong> curl command or just the token</li>
                      </ol>
                    </div>
                  </div>

                  <div class="alert alert--success">
                    <div class="alert__content">
                      <p style="margin: 0;"><strong>ðŸ’¡ Pro tip:</strong> Paste the entire <code>curl</code> command from Cloudflare into the <strong>Bootstrap API token</strong> field. We'll auto-extract both Account ID and token.</p>
                    </div>
                  </div>

                  <div class="field">
                    <button type="button" class="btn btn--primary" data-tab-trigger="scoped-token">
                      <span class="icon" data-icon="mono/play"></span>
                      <span>Start setup</span>
                    </button>
                  </div>
                </div>
              </div>

              <!-- Scoped Token Tab -->
              <div class="tabs__panel" data-tab-panel="scoped-token" role="tabpanel">
                <form class="stack-list" data-form="cf-connect-scoped">
                  <div class="field">
                    <label class="field__label">Cloudflare Account ID</label>
                    <input
                      class="input"
                      type="text"
                      name="cf_account_id"
                      placeholder="e.g. 1234567890abcdef1234567890abcdef"
                      required
                    />
                    <p class="field__hint text-muted">
                      Found in Cloudflare dashboard: <strong>Overview â†’ Account ID</strong>
                    </p>
                  </div>

                  <div class="field">
                    <label class="field__label">Bootstrap API Token</label>
                    <textarea
                      class="textarea"
                      name="cf_bootstrap_token"
                      rows="4"
                      placeholder="Paste token with 'Account API Tokens: Edit' scopeâ€¦"
                      required
                    ></textarea>
                    <p class="field__hint text-muted">
                      Created as <code>301st Bootstrap</code> with <strong>Account Settings: Edit</strong> and <strong>API Tokens: Edit</strong> permissions.
                    </p>
                  </div>

                  <div class="alert alert--success">
                    <div class="alert__content">
                      <p style="margin: 0;"><strong>ðŸ’¡ Pro tip:</strong> Paste the entire <code>curl</code> command from <strong>Test this token</strong> section, and we'll auto-extract both fields.</p>
                    </div>
                  </div>

                  <div class="field">
                    <button type="submit" class="btn btn--cf">
                      <span class="icon" data-icon="brand/cloudflare"></span>
                      <span>Save &amp; verify token</span>
                    </button>
                  </div>

                  <div class="alert" data-cf-status hidden role="status" aria-live="polite"></div>
                </form>
              </div>

              <!-- Quick Setup Tab -->
              <div class="tabs__panel" data-tab-panel="quick-setup" role="tabpanel">
                <form class="stack-list" data-form="cf-connect-quick">
                  <div class="alert alert--warning">
                    <div class="alert__content">
                      <p><strong>Warning:</strong> This method uses your Global API Key temporarily. We'll create a scoped token and immediately discard the Global API Key.</p>
                    </div>
                  </div>

                  <div class="field">
                    <label class="field__label">Cloudflare Account Email</label>
                    <input
                      class="input"
                      type="email"
                      name="cf_account_email"
                      placeholder="your-email@example.com"
                      autocomplete="email"
                      required
                    />
                    <p class="field__hint text-muted">
                      The email address associated with your Cloudflare account.
                    </p>
                  </div>

                  <div class="field">
                    <label class="field__label">Global API Key</label>
                    <textarea
                      class="textarea"
                      name="cf_global_key"
                      rows="3"
                      placeholder="Paste your Global API Keyâ€¦"
                      required
                    ></textarea>
                    <p class="field__hint text-muted">
                      Found in Cloudflare dashboard: <strong>My Profile â†’ API Tokens â†’ Global API Key â†’ View</strong>
                    </p>
                  </div>

                  <div class="field">
                    <button type="submit" class="btn btn--danger">
                      <span class="icon" data-icon="mono/zap"></span>
                      <span>Create scoped token</span>
                    </button>
                  </div>

                  <div class="alert" data-cf-status hidden role="status" aria-live="polite"></div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <footer class="drawer__footer">
          <button class="btn btn--ghost" type="button" data-drawer-close>Cancel</button>
        </footer>
      </div>
    </aside>
